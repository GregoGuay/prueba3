<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Casa tecnología</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <!-- Comentarios: guarda este archivo como `escena-aframe.html` y ábrelo en tu navegador -->
  <style>
    body { margin: 0; font-family: sans-serif; }
    .hint { position: fixed; left: 8px; top: 8px; background: rgba(0,0,0,0.5); color: white; padding: 6px 10px; border-radius: 6px; z-index: 999; }
  </style>
</head>
<body>
  <div class="hint">WASD / flechas para moverte • Click o tap para interactuar • Pulsa F11 para pantalla completa</div>

  <a-scene background="color: #88ccee" cursor="rayOrigin: mouse">

    <!-- Assets (texturas, modelos, sonidos) -->
    <a-assets>
      <!-- Puedes añadir aquí <img>, <audio>, <a-asset-item> para glTF, etc. -->
    </a-assets>

    <!-- Cámara con controles y cursor (usable en escritorio y móviles) -->
    <a-entity id="player" position="0 1.6 4">
      <a-entity camera look-controls wasd-controls="acceleration: 200" position="0 0 0">
        <a-entity cursor="fuse: false; rayOrigin: mouse" raycaster="objects: .clickable" position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
                  material="shader: flat; opacity: 0.9"></a-entity>
      </a-entity>
    </a-entity>

    <!-- Luz ambiente y direccional -->
    <a-entity light="type: ambient; intensity: 0.6"></a-entity>
    <a-entity light="type: directional; intensity: 0.8" position="-1 2 1"></a-entity>

    <!-- Suelo -->
    <a-plane rotation="-90 0 0" width="30" height="30" color="#4CAF50" shadow="receive: true"></a-plane>

    <!-- Cielo con gradiente (simulado con una esfera grande) -->
    <a-sky color="#87CEEB"></a-sky>

    <!-- Elementos interactivos -->
    <!-- Caja giratoria (clic para cambiar color) -->
    <a-box class="clickable"
           position="-1 0.75 -2"
           rotation="0 45 0"
           depth="1"
           height="1"
           width="1"
           material="color: #FF5722; metalness: 0.2; roughness: 0.6"
           animation="property: rotation; to: 0 405 0; loop: true; dur: 6000; easing: linear"
           event-set__enter="material.color: #FFC107"
           event-set__leave="material.color: #FF5722"
           >
    </a-box>

    <!-- Esfera flotante con animación de rebote -->
    <a-sphere class="clickable"
              position="1.5 1.2 -3"
              radius="0.6"
              material="color: #2196F3; opacity: 0.95"
              animation__bounce="property: position; dir: alternate; dur: 1200; loop: true; to: 1.5 1.8 -3; easing: easeInOutSine"
              ></a-sphere>

    <!-- Texto 3D informativo -->
    <a-entity position="0 2 -3">
      <a-text value="Gay el que lo lea." align="center" width="4" color="#111" ></a-text>
    </a-entity>

    <!-- Unos pequeños cilindros alrededor para decoración -->
    <a-cylinder position="-3 0.5 -4" radius="0.3" height="1" material="color: #795548"></a-cylinder>
    <a-cylinder position="-2 0.5 -4.5" radius="0.3" height="1.2" material="color: #6D4C41"></a-cylinder>
    <a-cylinder position="3 0.5 -5" radius="0.3" height="0.9" material="color: #8D6E63"></a-cylinder>

    <!-- Entidad que escucha clicks y muestra una animación breve -->
    <a-entity id="click-handler" position="0 0 0">
      <a-entity id="pulse" geometry="primitive: ring; radiusInner: 0.2; radiusOuter: 0.25" material="opacity: 0.7" visible="false"></a-entity>
    </a-entity>

    <!-- Script para interactividad extra -->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const clickables = document.querySelectorAll('.clickable');
        const pulse = document.querySelector('#pulse');

        // Efecto de pulso existente
        clickables.forEach(el => {
          el.addEventListener('click', () => {
            const pos = el.getAttribute('position');
            pulse.setAttribute('position', { x: pos.x, y: pos.y + 0.1, z: pos.z });
            pulse.setAttribute('visible', true);
            pulse.setAttribute('animation', 'property: scale; to: 4 4 4; dur: 300; easing: easeOutQuad');
            setTimeout(() => {
              pulse.setAttribute('visible', false);
              pulse.removeAttribute('animation');
            }, 320);
          });
        });

        // --- FIX DE LA PUERTA ---
        const door = document.querySelector('#door');
        let abierta = false;

        door.addEventListener('click', () => {
          if (!abierta) {
            door.setAttribute('animation__open', {
              property: 'rotation', to: '0 90 0', dur: 700, easing: 'easeOutQuad'
            });
          } else {
            door.setAttribute('animation__close', {
              property: 'rotation', to: '0 0 0', dur: 700, easing: 'easeOutQuad'
            });
          }
          abierta = !abierta;
        });
      });
    </script>

      <!-- Casa interactiva -->
    <a-entity id="house" position="0 0 -8">
      <!-- Paredes principales -->
      <a-box position="0 1.5 0" depth="6" height="3" width="3" color="#d9c7a3" material="roughness:0.8"></a-box>

      <!-- Suelos internos: 2 habitaciones + 1 baño -->
      <!-- Habitación izquierda -->
      <a-plane rotation="-90 0 0" position="-0.8 0.01 -1.5" width="1.2" height="2.8" color="#c8b89a"></a-plane>

      <!-- Habitación derecha -->
      <a-plane rotation="-90 0 0" position="0.8 0.01 -1.5" width="1.2" height="2.8" color="#c8b89a"></a-plane>

      <!-- Baño al fondo -->
      <a-plane rotation="-90 0 0" position="0 0.01 1.5" width="2.5" height="2.5" color="#bababa"></a-plane>

      <!-- Pared divisoria entre habitaciones -->
      <a-box position="0 1 -1.5" depth="0.05" height="2" width="3" color="#e2d5bc"></a-box>

      <!-- Pared divisoria del baño -->
      <a-box position="0 1 0.1" depth="0.05" height="2" width="3" color="#e2d5bc"></a-box>

      <!-- Techo -->
      <a-cone position="0 3.2 -1.5" radius-bottom="2.2" radius-top="0.1" height="1.5" color="#b54a1d"></a-cone>

      <!-- Puerta interactiva (con bisagra real) -->
      <!-- Puerta -->

      <!-- Puertas interiores -->
      <!-- Puerta habitación izquierda -->
      <a-box class="clickable" position="-0.6 0.75 -0.1" width="0.8" height="1.5" depth="0.05" color="#6b4a2b"></a-box>
      <!-- Puerta habitación derecha -->
      <a-box class="clickable" position="0.6 0.75 -0.1" width="0.8" height="1.5" depth="0.05" color="#6b4a2b"></a-box>
      <!-- Puerta baño -->
      <a-box class="clickable" position="0 0.75 0.6" width="1" height="1.5" depth="0.05" color="#6b4a2b"></a-box>

      <!-- Ventanas -->
      <a-plane position="-1.4 1.5 -1.5" width="1" height="0.7" color="#aee7ff" opacity="0.7"></a-plane>
      <a-plane position="1.4 1.5 -1.5" width="1" height="0.7" color="#aee7ff" opacity="0.7"></a-plane>
      <a-plane position="0 1.5 2.8" width="1.5" height="0.8" color="#aee7ff" opacity="0.7"></a-plane>

      <!-- Muebles habitación izquierda -->
      <a-box position="-1.1 0.45 -2" width="0.6" height="0.4" depth="1" color="#8d6e63"></a-box>
      <a-box position="-0.5 0.25 -2.3" width="0.4" height="0.25" depth="0.4" color="#9e9e9e"></a-box>

      <!-- Muebles habitación derecha -->
      <a-box position="1.1 0.45 -2" width="0.6" height="0.4" depth="1" color="#8d6e63"></a-box>
      <a-box position="0.5 0.25 -2.3" width="0.4" height="0.25" depth="0.4" color="#9e9e9e"></a-box>

      <!-- Muebles baño -->
      <a-cylinder position="-0.6 0.4 2" radius="0.3" height="0.8" color="#ffffff"></a-cylinder>
      <a-box position="0.6 0.5 2" width="0.6" height="0.6" depth="0.4" color="#e0e0e0"></a-box>

      <!-- Luces interiores -->
      <a-entity light="type: point; intensity: 0.6; distance: 5" position="-0.8 2 -1.5"></a-entity>
      <a-entity light="type: point; intensity: 0.6; distance: 5" position="0.8 2 -1.5"></a-entity>
      <a-entity light="type: point; intensity: 0.6; distance: 5" position="0 2 1.5"></a-entity> interactiva (con bisagra real) -->
      <!-- Contenedor que actúa como bisagra en el lado izquierdo -->
      <a-entity id="doorPivot" position="-0.5 0 1.52">
        <a-box id="door" class="clickable"
               position="0.5 0.75 0"
               depth="0.05" height="1.5" width="1"
               color="#5a3e1b">
        </a-box>
      </a-entity>
    </a-entity>

    <script>
      // Control de apertura/cierre de puerta
      document.addEventListener('DOMContentLoaded', function () {
        const door = document.querySelector('#door');
        let abierta = false;

        door.addEventListener('click', () => {
          if (!abierta) {
            door.emit('abrir');
          } else {
            door.emit('cerrar');
          }
          abierta = !abierta;
        });
      });
    </script>

  </a-scene>
</body>
</html>
